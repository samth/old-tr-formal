(define exam-grades
  '(("Aaron Portnoy" 47 42)
 ("Aaron Tatko" 47 45)
 ("Adam Gorklo" 24 11)
 ;("Adam Koblentz" 30 did-not-take-exam-2)
 ("Adem Chich" 45 31)
 ("Alex Coleman" 46 48)
 ("Alexander Typaldos" 35 24)
 ("Allen Dewberry" 17 19)
 ("Anatoly Feldman" 49 30)
 ("Andres Weber" 27 27)
 ("Andrew Alix" 32 12)
 ("Andrew Guida" 48 50)
 ("Andrew Kunkel" 45 41)
 ("Ayellet Damary" 32 26)
 ("Bassil Silver-Hajo" 45 37)
 ;("Berryman, Ken" 24 did-not-take-exam-2)
 ;("Brad Turnier" 9 did-not-take-exam-2)
 ("Brandon Schory" 53 45)
 ;("Brendan Doherty" 35 did-not-take-exam-2)
 ("Brian Silva" 42 23)
 ("Brian Tobia" 47 38)
 ("Caniparoli, Jacob" 48 37)
 ("Carmine Silano" 53 39)
 ("Carol Lee" 48 34)
 ("Chabot, Jon" 28 39)
 ;("Chebbani, Adam" 11 did-not-take-exam-2)
 ("Chris Chalifour" 48 46)
 ("Chris Masciarelli" 40 29)
 ("Chris Trammell" 25 19)
 ("Chris Willis" 46 45)
 ("Christina Carter" 36 31)
 ("Christopher Boudouvas" 35 27)
 ;(what??? ("Christopher Looney") ("Christopher Looney"))
 ("Christopher Svenson" 36 29)
 ;("Christopher Teixeira" 14 did-not-take-exam-2)
 ("Christopher Umina" 43 35)
 ("Christos Goumenos" 45 41)
 ;(what??? ("Chua, Ryan") ("Chua, Ryan"))
 ("Corey Gamache" 47 43)
 ("Courtney Moores" 37 23)
 ("Damien Angelos" 51 50)
 ("Dan Gaylord" 54 44)
 ("Dan Schiffman" 37 40)
 ("Daniel Marcucci" 46 41)
 ("Daniel Noonan" 40 32)
 ("Daniel Rabinowitz" 42 40)
 ("Daniel Smedemark-Mar" 33 25)
 ("Daniela Cervasio" 23 10)
 ("David Benjamin" 50 44)
 ("Duc Tri Le" 48 49)
 ("Earl Robsham" 47 54)
 ("Eileen Ryan" 40 32)
 ;("Elvin Taullaj" 14 did-not-take-exam-2)
 ("Eric Blumenstyk" 32 39)
 ("Eric Liljebach" 34 32)
 ("Fardad Askarzadeh" 50 46)
 ("Francisco, Jeff" 52 45)
 ("Gagnon, Mike" 53 50)
 ;("Gregg Hurson" 32 did-not-take-exam-2)
 ("Halperin, David" 52 49)
 ("Hilary Ferraro" 42 37)
 ("House, Sarah" 55 48)
 ("Jake Dreier" 30 31)
 ("Jared Assmus" 55 49)
 ("Jeffrey Begin" 42 29)
 ("Jennifer Lussier" 52 39)
 ("Jeremiah Johnson" 44 35)
 ("Jeremy Mckenzie" 41 30)
 ("Jerry Mui" 48 41)
 ;("John Clevesy" 49 did-not-take-exam-2)
 ("John Patota" 26 14)
 ("Johnson, Nicole" 48 42)
 ("Jon McKenzie" 37 36)
 ("Jon Sporn" 50 45)
 ("Jonathan Albertelly" 51 41)
 ("JongHyun Cho" 46 33)
 ("Joseph Holsten" 45 41)
 ("Kari Karvinen" 48 40)
 ("Kathryn Vanderwyk" 47 45)
 ("Kenneth Eimer" 53 43)
 ("Killion, James" 51 40)
 ("Kristin Farris" 24 24)
 ("Kyle Banks" 51 43)
 ("Kyros, Matt" 47 39)
 ("Lee Fogel" 55 43)
 ("Lee, Alfredo" 50 47)
 ("Logel, Joe" 42 27)
 ("Manning, James" 41 37)
 ("Manny Batista" 54 40)
 ;(what??? ("Manolo Solis") ("Manolo Solis"))
 ("Marc Mestre" 41 25)
 ("Mark Santoski" 53 44)
 ("Mark Shoaie" 51 38)
 ("Mark Spadea" 35 19)
 ("Mark Ursino" 50 46)
 ("Mathew Dombrowski" 46 42)
 ("Matt DeGenarro" 40 42)
 ("Matt Haslett" 32 18)
 ("Matt Horan" 50 44)
 ("Matthew Peterson" 44 52)
 ("Matthew Schroder" 50 49)
; (what??? ("Matthew Skolnick") ("Matthew Skolnick"))
 ("Michael Altman" 45 26)
 ("Michael Battista" 54 53)
 ("Michael DiStaula" 52 50)
 ("Michael McIntosh" 41 45)
 ("Michael Reid" 46 44)
 ("Mike Nelligan" 50 41)
 ("Mike Rastello" 21 22)
 ;("Najdzien, Derek" 28 did-not-take-exam-2)
 ("Nate Whittier" 53 44)
 ("Nick Rezendes" 46 37)
 ("Nikolopolous, Constantine" 30 19)
 ("O'Grady, Matt" 46 32)
 ("Olga Klepikova" 49 36)
 ("Patrick Kaeding" 54 50)
 ("Peter Evans" 50 48)
 ("Raffile, Kyle" 41 40)
 ("Randall Dailey" 48 33)
 ("Rishi Aggarwal" 49 52)
 ("Ritter, Kathrin" 44 31)
 ("Robert Gable" 38 44)
 ("Ronald Thompson" 46 38)
 ("Ross Ramsay" 47 43)
 ("Ryan Lafountain" 47 46)
 ("Sang Hyun Lee" 32 18)
; ("Sean Devine Hughes" 8 did-not-take-exam-2)
 ("Sergey Andreev" 47 42)
 ("Shatkovsky, Vitaly" 55 51)
 ("Skyler Insler" 41 43)
 ("Suraj Laungani" 26 22)
 ("Thomas Blatchford" 44 33)
 ("Thomas Cody" 39 20)
 ("Thomas Harrold" 44 36)
 ("Thomas Pappas" 53 49)
 ("Tim LaRose" 42 39)
 ("Travis Stone" 24 27)
; ("Wesley Werbeck" 28 did-not-take-exam-2)
 ("Wilson, Janet" 50 46)))



(define old-exam-grades
  '(("Aaron Portnoy" 47)
 ("Aaron Tatko" 47 45)
 ("Adam Gorklo" 24 11)
 ("Adam Koblentz" 30)
 ("Adem Chich" 45 31)
 ("Alex Coleman" 46 48)
 ("Alexander Typaldos" 35 24)
 ("Allen Dewberry" 17)
 ("Anatoly Feldman" 49)
 ("Andres Weber" 27)
 ("Andrew Alix" 32)
 ("Andrew Guida" 48 50)
 ("Andrew Kunkel" 45 41)
 ("Ayellet Damary" 32 26)
 ("Bassil Silver-Hajo" 45 37)
 ("Berryman, Ken" 24)
 ("Brad Turnier" 9)
 ("Brandon Schory" 53)
 ("Brendan Doherty" 35)
 ("Brian Silva" 42)
 ("Brian Tobia" 47)
 ("Caniparoli, Jacob" 48 37)
 ("Carmine Silano" 53 39)
 ("Carol Lee" 48)
 ("Chabot, Jon" 28)
 ("Chebbani, Adam" 11)
 ("Chris Chalifour" 48)
 ("Chris Masciarelli" 40 29)
 ("Chris Trammell" 25)
 ("Chris Willis" 46 45)
 ("Christina Carter" 36 31)
 ("Christopher Boudouvas" 35)
 ("Christopher Looney")
 ("Christopher Svenson" 36 29)
 ("Christopher Teixeira" 14)
 ("Christopher Umina" 43 35)
 ("Christos Goumenos" 45)
 ("Chua, Ryan")
 ("Corey Gamache" 47)
 ("Courtney Moores" 37)
 ("Damien Angelos" 51)
 ("Dan Gaylord" 54 44)
 ("Dan Schiffman" 37 40)
 ("Daniel Marcucci" 46 41)
 ("Daniel Noonan" 40 32)
 ("Daniel Rabinowitz" 42 40)
 ("Daniel Smedemark-Mar" 33)
 ("Daniela Cervasio" 23 10)
 ("David Benjamin" 50)
 ("Duc Tri Le" 48)
 ("Earl Robsham" 47)
 ("Eileen Ryan" 40 32)
 ("Elvin Taullaj" 14)
 ("Eric Blumenstyk" 32 39)
 ("Eric Liljebach" 34)
 ("Fardad Askarzadeh" 50)
 ("Francisco, Jeff" 52)
 ("Gagnon, Mike" 53)
 ("Gregg Hurson" 32)
 ("Halperin, David" 52 49)
 ("Hilary Ferraro" 42 37)
 ("House, Sarah" 55 48)
 ("Jake Dreier" 30)
 ("Jared Assmus" 55)
 ("Jeffrey Begin" 42)
 ("Jennifer Lussier" 52)
 ("Jeremiah Johnson" 44)
 ("Jeremy Mckenzie" 41)
 ("Jerry Mui" 48)
 ("John Clevesy" 49)
 ("John Patota" 26)
 ("Johnson, Nicole" 48)
 ("Jon McKenzie" 37 36)
 ("Jon Sporn" 50 45)
 ("Jonathan Albertelly" 51)
 ("JongHyun Cho" 46 33)
 ("Joseph Holsten" 45)
 ("Kari Karvinen" 48 40)
 ("Kathryn Vanderwyk" 47 45)
 ("Kenneth Eimer" 53)
 ("Killion, James" 51)
 ("Kristin Farris" 24)
 ("Kyle Banks" 51)
 ("Kyros, Matt" 47)
 ("Lee Fogel" 55)
 ("Lee, Alfredo" 50 47)
 ("Logel, Joe" 42 27)
 ("Manning, James" 41)
 ("Manny Batista" 54 40)
 ("Manolo Solis")
 ("Marc Mestre" 41)
 ("Mark Santoski" 53 44)
 ("Mark Shoaie" 51)
 ("Mark Spadea" 35)
 ("Mark Ursino" 50 46)
 ("Mathew Dombrowski" 46 42)
 ("Matt DeGenarro" 40 42)
 ("Matt Haslett" 32 18)
 ("Matt Horan" 50)
 ("Matthew Peterson" 44)
 ("Matthew Schroder" 50 49)
 ("Matthew Skolnick")
 ("Michael Altman" 45 26)
 ("Michael Battista" 54)
 ("Michael DiStaula" 52 50)
 ("Michael McIntosh" 41 45)
 ("Michael Reid" 46)
 ("Mike Nelligan" 50 41)
 ("Mike Rastello" 21 22)
 ("Najdzien, Derek" 28)
 ("Nate Whittier" 53)
 ("Nick Rezendes" 46 37)
 ("Nikolopolous, Constantine" 30)
 ("O'Grady, Matt" 46)
 ("Olga Klepikova" 49)
 ("Patrick Kaeding" 54 50)
 ("Peter Evans" 50)
 ("Raffile, Kyle" 41)
 ("Randall Dailey" 48)
 ("Rishi Aggarwal" 49)
 ("Ritter, Kathrin" 44 31)
 ("Robert Gable" 38)
 ("Ronald Thompson" 46 38)
 ("Ross Ramsay" 47 43)
 ("Ryan Lafountain" 47)
 ("Sang Hyun Lee" 32 18)
 ("Sean Devine Hughes" 8)
 ("Sergey Andreev" 47)
 ("Shatkovsky, Vitaly" 55 51)
 ("Skyler Insler" 41 43)
 ("Suraj Laungani" 26 22)
 ("Thomas Blatchford" 44)
 ("Thomas Cody" 39)
 ("Thomas Harrold" 44 36)
 ("Thomas Pappas" 53)
 ("Tim LaRose" 42 39)
 ("Travis Stone" 24)
 ("Wesley Werbeck" 28)
 ("Wilson, Janet" 50 46)))
(require (lib "list.ss") (lib "etc.ss"))
(define took-exam (filter (lambda (x) (= 3 (length x) )) exam-grades))

(define in-trouble (filter (lambda (x) (< (cadr x) 25)) took-exam ))
(define in-trouble-2 (filter (lambda (x) (< (caddr x) 25)) took-exam ))

(define exam-2-scores (map caddr took-exam))
(define exam-1-scores (map cadr took-exam))

(define (bounded n m) (lambda (x) (and (< x m) (>= x n))))

(define (avg l) (quotient (apply + l) (length l)))

(define (median l) (list-ref (quicksort l <) (quotient (length l) 2)))

(define 50-up (filter (bounded 50 60) exam-scores))
(define 45-49 (filter (bounded 45 50) exam-scores))
(define 40-44 (filter (bounded 40 45) exam-scores))
(define 30-39 (filter (bounded 30 40) exam-scores))
(define 0-29 (filter (bounded 0 30) exam-scores))



(define (buckets size l)
  (map (lambda (n)
         (cons n (filter (bounded n (+ n size)) l)))
       (map (lambda (n) (* n size))
            (build-list (+ (quotient 55 size) 1) values))))

(define (asterisks n)
  (if (= n 0) ""
      (string-append "*" (asterisks (- n 1)))))
(define (display-buckets n l)
  (for-each (lambda (p)
              (let ((header
                     (if (< (car p) 10)
                         (format " ~a" (car p))
                         (format "~a"  (car p)))))
                (display (format "~a : ~a~n"
                                 header
                                 (asterisks (length (cdr p)))))))
            (buckets n l)))


(require (lib "match.ss"))

(define (merge-student x y)
  (let ((l1 (length x))
        (l2 (length y)))
    (match (list l1 l2)
           [(3 2) x]
           [(2 3) y]
           [(2 2) (list (car x) (cadr x) 'did-not-take-exam-2)]
           [(3 3) (error "duplicate entry" x y)]
           [z (list 'what??? x y )])))


(define (improved-exam st)
  (< (cadr st) (caddr st)))

(define (bad-on-2nd st)
  (> (cadr st) (+ 10 (caddr st))))

(define (very-good-on-both st)
  (and (> (cadr st) 47)
       (> (caddr st) 47)))