\documentclass[12pt]
{article}

\usepackage{amssymb}
\usepackage{amsmath}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{problem}[theorem]{Problem}

% General
\def\credittype{}
\def\RC{\credittype{RC}}
\def\EC{\credittype{EC}}
\def\NA{\credittype{NA}}

\newcommand\prob[1]{\noindent{\em #1 }\vspace{2mm}}


% Machines
\def\machine{\sf}
\def\mdfa{{\machine DFA}}
\def\mnfa{{\machine NFA}}
\def\mgnfa{{\machine GNFA}}
\def\mcfg{{\machine CFG}}
\def\mcfl{{\machine CFL}}
\def\mpda{{\machine PDA}}

% Grammar things
\newcommand\mygrammar[1]{
$$
\begin{array}{rcll}
#1
\end{array}
$$
}
\newcommand\gr[3]{\ensuremath{{\mit #1} &\rightarrow& #2 & ~~~~;~#3} \\}
\newcommand\gb[3]{\ensuremath{&|& #2 & ~~~~;~#3} \\}
\newcommand\dr[2]{\ensuremath{{\mit #1} &\Rightarrow& #2 &} \\}
\newcommand\db[1]{\ensuremath{&\Rightarrow& #1 &} \\}
\def\por{~|~}
\def\mt{\mathtt}

% Jay's 5 rules
\newcommand\jaarule[1]{\ensuremath{\mbox{{\sc JaysRule{#1}}}}}

% # in tt
\def\h{\ensuremath{\mt{\#}}}

% Graph stuff
\newcommand\pedge[3]{\ensuremath{#1,#2 \rightarrow #3}}
\def\pedgexxx{\pedge}
\newcommand\pedgeexx[2]{\pedge{\epsilon}{#1}{#2}}
\newcommand\pedgexex[2]{\pedge{#1}{\epsilon}{#2}}
\newcommand\pedgexxe[2]{\pedge{#1}{#2}{\epsilon}}
\newcommand\pedgexee[1]{\pedge{#1}{\epsilon}{\epsilon}}
\newcommand\pedgeexe[1]{\pedge{\epsilon}{#1}{\epsilon}}
\newcommand\pedgeeex[1]{\pedge{\epsilon}{\epsilon}{#1}}
\newcommand\pedgeeee[0]{\pedge{\epsilon}{\epsilon}{\epsilon}}

% Non-terminals
\newcommand\nterm[1]{\ensuremath{\langle\mbox{{\sc #1}}\rangle}}

\newcommand\sr[2]{\ensuremath{{\mit #1}  \rightarrow #2}}


\newenvironment{proof}[1][Proof]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}

\newcommand{\qed}{\nobreak \ifvmode \relax \else
      \ifdim\lastskip<1.5em \hskip-\lastskip
      \hskip1.5em plus0em minus0.5em \fi \nobreak
      \vrule height0.75em width0.5em depth0.25em\fi}

\title{CSG 713: Problem Set 4}
\author{Sam Tobin-Hochstadt}
\date{\today}

\begin{document}

\maketitle

\subsection*{Problem 1}

\prob{Prove that the context-free languages are closed under reverse.}

Consider a language $A$ that is context-free.  Then there exists a
Chomsky normal form grammar $G$, such that $L(G) = A$. Then the
language $Reverse(A)$ is generated by the grammar $G'$, defined as
follows:

For all productions of the form \sr{A}{BC}, replace them with
productions \sr{A}{CB}.  For productions of the for \sr{A}{a}, leave
them unchanged.  

{\em Claim:} If a parse tree starting at non-terminal $N$ was
generated by $G$, then the mirror image of that parse tree, starting
at the same nonterminal, is generated by $G'$.

Proof by induction on the height of the parse tree.  

Base Case: If the height is 1, then $w$ was generated by a single
production from the start symbol to a terminal.  By construction, that
production is in $G'$, so the parse tree can be generated by $G'$.

Inductive Step.  Consider the root of the tree.  If we are not in the
base case, then the start symbol generates exactly two trees.  By the
induction hypothesis, both the left and the right subtrees are the
mirror images of trees produced by $G$.  Therefore, since the
production at the root of the tree is of the form \sr{A}{CB}, there
must have been a production in $G$ of the form \sr{A}{BC}.  Therefore,
G must have produced a tree with the same root, and with mirrored
subtrees, but with the left and right subtrees reversed.  This is
precisely a mirror image of the current tree.  \qed

Now consider those trees which have the start symbol at the root, and
which have terminals at all the leaves.  These are the trees that
generate some string $w$, where $w \in L(G)$.  By the above claim,
the mirror image tree must be generated by $G'$.  This mirror tree
generates precisely the string $w^R$.  Therefore, if $w \in L(G) = A$,
then $w^R \in L(G')$.  So $A^R \subseteq L(G')$. 

To prove that $L(G') = A^R$, consider the grammar $G''$, obtained by
applying the original construction to $G'$.  Then we have ${A^R}^R
\subseteq L(G'')$, or $A \subseteq L(G'')$. But $G'' = G$, so no new
strings have been added.  Therefore,  $L(G') = A^R$.

\subsection*{Problem 2}

\prob{Sipser 2.18 (a,c)}

\subsubsection*{Part A}

Let $A = \{0^n1^n0^n1^n~|~n\geq 0\}$.  We use the pumping lemma to
show that $A$ is not context-free.  

Assume $A$ is context free.  Let $p$ be the pumping length given by
the pumping lemma.  Choose $s = 0^p1^p0^p1^p$.  Let $s = uvxyz$ and
consider the following cases.  

\begin{enumerate}
  \item If either $v$ or $y$ contain more than one type of symbol,
  then $uv^2xy^2z \not\in 0^*1^*0^*1^*$.  

\item Since both $v$ and $y$ contain one type of symbol, each must be
  entirely contained with in one for the four blocks in $s$.  Then
  there must be two blocks left out.  Then consider $s' = uv^0xy^0z$.  This
  will have fewer symbols in at most two of the blocks.  Therefore,
  there will be at least two blocks whose lengths do not change, and
  at least one which is shorter.  Therefore, $s' \not\in A$.  
\end{enumerate} 

\subsubsection*{Part B}

Let $A = \{w\h x~|~w$ is a substring of $x \}$.  We use the pumping
lemma to show that $A$ is not context-free.

Assume $A$ is context free.  Let $p$ be the pumping length given by
the pumping lemma.  Choose $s = 0^p1^p\h 0^p1^p$.  Let $s = uvxyz$ and
consider the following cases.  

\begin{enumerate}
\item If either $v$ or $y$ contains a \h, then $uv^0xy^0z$ does not,
  and is not in $A$.

\item If both $v$ and $y$ come before the \h, then $uv^2xy^2z$ has a
  longer substring before the \h than after, and thus is not in $A$.

\item If both $v$ and $y$ come after the \h, then $uv^0xy^0z$ has a
  longer substring before the \h than after, and thus is not in $A$.

\item If $v$ is before the \h, and $y$ is after, then $v = 1^k$ and $y
  = 0^l$, for some $k,l$ not both 0.  Then if $k = 0$, $uv^0xy^0z$ has
  a longer substring before the \h than after, and thus is not in
  $A$.  On the other hand, if $k \neq 0$, $uv^2xy^2z$ has more 1s
  before the \h than after, and thus $w$ cannot be a substring of
  $x$.  Therefore, it is not in $A$.  
\end{enumerate}

Since these cases are exhaustive, $A$ is not context-free. 

\subsection*{Problem 3}

Let $A = \{0^n 1^m~|~ m = n^2 \}$.  We use the pumping
lemma to show that $A$ is not context-free.

Assume $A$ is context free.  Let $p$ be the pumping length given by
the pumping lemma.  Choose $s = 0^{p^2}1^p$.  Let $s = uvxyz$ and
consider the following cases.  

\begin{enumerate}
\item If either $v$ or $y$ contains both 0s and 1s, then $uv^2xy^2z$
  is not of the form $0^*1^*$, and is thus not in $A$.
\item If $v$ and $y$ consist of either both 1s or both 0s, then
  $uv^2xy^2z$ is not in $A$, since $|vy| \neq 0$, and therefore $p^2
  \neq p^2 + |vy|$, and $(p+|vy|)^2 \neq p^2$.

\item If $v$ consists of 0s, and $y$ consists of 1s, then either
  $uv^2xy^2z$ or $uv^3xy^3z$ is not in $A$, since this would require
  that $p^2+|v| = (p+|y|)^2$ and $p^2+2*|v| = (p+2*|y|)^2$, which
  implies that $|v| = |y|^2$, and $|v| = 2*|y|^2$, which requires that
  $|vy| = 0$.

\end{enumerate}

Since these cases are exhaustive, $A$ is not context-free. 

\subsection*{Problem 4}

Let $A = \{ww^Rw~|~ w \in \{0,1\}^* \}$.  We use the pumping
lemma to show that $A$ is not context-free.

Assume $A$ is context free.  Let $p$ be the pumping length given by
the pumping lemma.  Choose $s = 0^p1^p1^p0^p 0^p1^p$.  Let $s = uvxyz$ and
consider the following cases.  

\begin{enumerate}
\item If either  $v$ or $y$ contains both 0s and 1s, then $uv^2xy^2z$
  will not be in $A$.  

\item Since $|vxy| \leq p$, either $vxy$ consists of only 1s or only
  0s, or $vxy$ is wholly contained within one of the thirds of the
  original string.  If the latter is true, then $uv^2xy^2z$ will
  increase the length of only one of the sections, and the new string
  will not be in $A$.  If the former is true, then there will be more
  of the symbol in $vxy$ in whichever half of $s$ that substring appears in
  than in the other half of $s$.  Therefore, the new string will not
  have the form $ww^Rw$, and thus not be in $A$.  

\end{enumerate}

Since these cases are exhaustive, $A$ is not context-free. 

\subsection*{Problem 5}

Let $A = \{a^nb^nc^m~|~ m \neq n \}$.  To show that $A$ satisfies the
requirements of the strong version of the pumping lemma, we need to
show that there exists an integer $k$, such that for any string $s \in
A$, $s = uvxyz$, with $|vy| > 0$, $|vxy| \leq k$, and $\forall n
\geq 0~uv^nxy^nz \in A$.  

To show this, choose an integer $k > 10$.  Then, given $s = a^nb^nc^m$,
consider two cases.
\begin{enumerate}
\item If $n > m$, choose $v$ and $y$ to be equal length strings, with
  $v$ consisting of a's, and $y$ consisting of b's so that $|n - m|
  \neq |v|$.  Then $\forall n \geq0 ~uv^nxy^nz \in A$.

\item If $m > n$, then choose $v$ to be empty, and $y$ to be a string
  of c's so that $|n - m| \neq |y|$.  Further, choose $u$ to be the
  rest of the string.  Then $uy^n \in A$ for any $n$.

\end{enumerate}

Therefore, for any string $s$, it can be broken into 5 parts so that
the conditions are met.  

\end{document}
